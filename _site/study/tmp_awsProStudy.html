<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Global Accelerator VS Cloud Front ¬∑ glucolte</title>
  <meta name="description" content="notes ‚Ä¢ principles ‚Ä¢ systems">
  <link rel="stylesheet" href="/assets/style.css">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/favicon.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Global Accelerator VS Cloud Front | glucolte</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Global Accelerator VS Cloud Front" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="notes ‚Ä¢ principles ‚Ä¢ systems" />
<meta property="og:description" content="notes ‚Ä¢ principles ‚Ä¢ systems" />
<link rel="canonical" href="http://localhost:4000/study/tmp_awsProStudy.html" />
<meta property="og:url" content="http://localhost:4000/study/tmp_awsProStudy.html" />
<meta property="og:site_name" content="glucolte" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Global Accelerator VS Cloud Front" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"notes ‚Ä¢ principles ‚Ä¢ systems","headline":"Global Accelerator VS Cloud Front","url":"http://localhost:4000/study/tmp_awsProStudy.html"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
  <header class="site-header">
    <a class="brand" href="/">glucolte</a>
    <nav class="nav">
      <a href="/">home</a>
      <a href="/principles">principles</a>
      <a href="/rules">rules</a>
      <a href="/stretches">stretches</a>
      <a href="/study/">study</a>
      <a href="/projects/">projects</a>
      <a href="/setup/">setup</a>
    </nav>
  </header>

  <main class="container">
    <article class="content">
      
<h2 id="global-accelerator-vs-cloud-front">Global Accelerator VS Cloud Front</h2>

<ul>
  <li>Global Accelerator:
    <ul>
      <li>Start with 2 anycast IP addresses (1.2.3.4 and 4.3.2.1)</li>
      <li>Anycast: Allow a single ip to be in multiple locations, routing moves traffic to closest location
        <ul>
          <li>Once the customer hits the closest Location</li>
          <li>It transit that data to the destination over AWS dedicated fibre link (Less Hops)</li>
        </ul>
      </li>
      <li>Moves AWS network closer to Customer to hit the original Destination</li>
      <li>Network Product -&gt; TCP/UDP  only
        <ul>
          <li>DOES NOT CACH ANYTHING</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Cloudfront:
    <ul>
      <li>Put the distribution to the edge closer to the customer</li>
      <li>Caching it at edge location, moves content closer</li>
      <li>BUT it does not use the fibre link</li>
      <li>Application Layer -&gt; HTTP only</li>
    </ul>
  </li>
</ul>

<h2 id="ipsec-vpn">IPSEC VPN</h2>
<ul>
  <li>Symmetric - Fast</li>
  <li>Asymmetric - Slow</li>
  <li>IKE Phase 1
    <ul>
      <li>Authenticate with Pre Shared key/Certificate</li>
      <li>Using Asymmetric encryption to agree on and craete a shared symmetric key</li>
      <li>IKE SA created</li>
    </ul>
  </li>
  <li>IKE Phase 2
    <ul>
      <li>use Phase 1 Key</li>
      <li>Agree encryption method and used for bulk data transfer</li>
      <li>Create IPSEC SA phase 2 tunnel</li>
    </ul>
  </li>
  <li>TLS: runs above TCP; typically mapped to L6. Protects application data (e.g., HTTP).
    <ul>
      <li>Key exchange: RSA (legacy, no forward secrecy) or DH/ECDH (modern, forward secrecy; TLS 1.3 = ECDHE only).</li>
      <li>Auth: usually X.509 certs; RSA/ECDSA used for signatures.</li>
    </ul>
  </li>
  <li>IPSec: protects whole IP packets at L3 (ESP/AH); setup via IKE, which feels like L5.
    <ul>
      <li>Key exchange: DH/ECDH only (for shared secret).</li>
      <li>Auth: certs or PSK; RSA/ECDSA used for signatures (not for encrypting a premaster).</li>
      <li>Two steps: Phase 1 (IKE SA, like a TLS-style secure control channel) ‚Üí Phase 2 (IPSec SAs for data traffic).</li>
    </ul>
  </li>
  <li>Similarity (when using DH/ECDH):
    <ul>
      <li>Both do a DH/ECDH exchange to derive a shared secret, then expand to symmetric session keys.</li>
      <li>Both can use certificates for peer authentication.</li>
    </ul>
  </li>
  <li>Key difference:
    <ul>
      <li>TLS can use RSA or DH/ECDH for key exchange (but modern = DH/ECDH).</li>
      <li>IPSec/IKE uses DH/ECDH only; RSA is just for signing/auth.</li>
    </ul>
  </li>
  <li>Single Pair Association</li>
</ul>

<h3 id="route-based-vpns">Route Based VPNS</h3>
<ul>
  <li>Target matching</li>
  <li>Matches a single pair of SAs per prefix
    <ul>
      <li>e.g. for a prefix uses 1 phase 2 tunnel, and another for another</li>
    </ul>
  </li>
  <li>Each Policy = SA pair = Unique IPSEC Key
    <ul>
      <li>More flexibility and secure</li>
    </ul>
  </li>
</ul>

<h2 id="site-to-site-vpn">Site to SIte VPN</h2>
<ul>
  <li>Uses IPSec ACROSS Public Internet</li>
  <li>FULL HA, if you design and implemetn it correctly</li>
  <li>Quick to provision</li>
  <li>Virtual Private Gateway (VGW) - ONLY 1
    <ul>
      <li>WIthin AWS Public Zone NOT Public Internet</li>
      <li>2x across different AZ to ensure Highly Avilably</li>
      <li>each VGW can have multiple endpoints
        <ul>
          <li>You use the endpoint to establish connection to CGW</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Customer Gateway (CGW)
    <ul>
      <li>At customer size</li>
      <li>If only 1 x on premisis -&gt; Partial Highly Avilability</li>
      <li>2x on Premises (Separate building) to ensure High Avilaibility</li>
    </ul>
  </li>
  <li>VPN Tunnel Connection connectes VPG and CG
    <ul>
      <li>Can have two endpoints for Tunnel for avilability</li>
      <li>Connects the Endpoint over Public Internet to CGW</li>
    </ul>
  </li>
  <li>VGW != VPN Tunnel
    <ul>
      <li>Tunnel is the ACTUAL Connection
  -</li>
    </ul>
  </li>
</ul>

<p>Static VPN</p>
<ul>
  <li>uses static routes at route table</li>
  <li>statisitcally configured on the VPN connection</li>
  <li>Cons:
    <ul>
      <li>No Load balancing and multi connection failover</li>
    </ul>
  </li>
</ul>

<p>Dynamic VPN</p>
<ul>
  <li>uses BGP on both the customer and AWS side using ASN, networks are exchanged via BGP</li>
  <li>Multiple VPN connections provide HA and traffic distriubtion</li>
  <li>Can still add Static routes but also route propagation</li>
</ul>

<p>VPN Consideration</p>
<ul>
  <li>Speed limit = 1.25Gbps</li>
  <li>Latency Consideration -&gt; VPNs are inconsistent as it travels through Public Internet</li>
  <li>COST - AWS Hourly, GB Out cost, Data Cap</li>
  <li>Soeed setup- as everything is over the internet on software level</li>
  <li>Can be used as a backup for DX</li>
  <li>Can be used with DX</li>
</ul>

<h2 id="transit-gateway-tgw">Transit Gateway (TGW)</h2>
<ul>
  <li>Allows VPC to interconnect</li>
  <li>Network Transit hub to connect VPCs to on premises networks</li>
  <li>Significantly reduces network complexity</li>
  <li>Single network Object - HA and Scalable</li>
  <li>Attachements to other network types</li>
  <li>
    <p>VPC, Site to Site VPN &amp; Direct Connect</p>
  </li>
  <li>1 single TGW can route traffic to VPCs</li>
  <li>
    <p>VPC Attachements are configured with a subnet in each AZ where service is required</p>
  </li>
  <li>Considerations:
    <ul>
      <li>Transitive Routing (it basically routes for any attached, if you setup correctly)</li>
      <li>Can be used to create global networks</li>
      <li>Share between accounts using AWS RAM</li>
      <li>Peer with regions same or cross account</li>
      <li>Offers less complexity vs full mesh topology</li>
    </ul>
  </li>
</ul>

<p>Transit gateway</p>
<ul>
  <li>Has one RT</li>
  <li>All attachements use this RT for routing decisions</li>
  <li>all attachements propagate and add routes</li>
  <li>Peer Attachement  (TGW peer with TGW)
    <ul>
      <li>Cross Region</li>
      <li>Max 50 per TGW</li>
      <li>Routes are NOT shared for Peered TGWs
        <ul>
          <li>You need to statisticall add</li>
        </ul>
      </li>
      <li>Encrypted</li>
      <li>Public DNS to private IP resolution DOES NOT WORK</li>
    </ul>
  </li>
  <li>All attachements can route to all attachements</li>
  <li>Bit confused on Association vs Propagation
    <ul>
      <li>Isolated Routing ?</li>
      <li>You can attached isolated Route table to VPC?</li>
    </ul>
  </li>
</ul>

<p>Leetcode is also about training your mindset with coding</p>
<ul>
  <li>You are certain about the implication of your algorithm</li>
</ul>

<h1 id="transit-gateway-deep-dive">Transit Gateway Deep Dive</h1>

<ul>
  <li>Transit Gateway -&gt; Layer 3</li>
  <li>Transift VIF (Virtual Interface)</li>
  <li>A TGW by default has one RT
    <ul>
      <li>Propagate and associate</li>
    </ul>
  </li>
</ul>

<p>ASSOCIATION:
    Determines WHICH subnets USE this route table
    It‚Äôs like saying ‚Äúthis subnet will use this route table for routing decisions‚Äù
    One subnet can only be associated with one route table at a time
    Example: Associating a subnet to a custom route table means that subnet will use those routes</p>

<p>PROPAGATION:
    Automatically ADDS routes to the route table
    Allows routes to be dynamically shared/advertised to the route table
    Common with VPN, Transit Gateway, or Virtual Private Gateway connections
    Example: When you enable route propagation from a Virtual Private Gateway, it automatically adds VPN routes to your route table</p>

<p>Simple analogy:
    Association is like assigning a map to someone (which directions to follow)
    Propagation is like automatically updating that map with new routes (adding new directions)</p>

<p>Default Configuration:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Yes, by default Transit Gateway comes with 1 default route table
All attachments are associated with this default route table initially
</code></pre></div></div>

<p>Multiple Route Tables:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Yes, you CAN create multiple route tables in a Transit Gateway
This is useful for complex routing scenarios or network segmentation
Common use case: Separating Dev and Prod environments
</code></pre></div></div>

<p>Attachments vs Route Tables:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Each attachment (VPC, VPN, Direct Connect) can only be associated with ONE route table
However, one route table can have MULTIPLE attachments
Routes can be propagated from multiple attachments to multiple route tables
</code></pre></div></div>

<p>Each attachement to TGW can associate to 1 RT (1:1) and if not defined, use default
You can let attachedment propagages it route
When a resource is attached to a Transit Gateway, it only establishes the initial connection - like plugging in a network cable. At this point, the Transit Gateway knows the resource exists, but other attached resources (like other VPCs) can‚Äôt communicate with it yet. This is where route propagation becomes crucial - it advertises the routes to other resources connected to the Transit Gateway, essentially saying ‚Äúhere‚Äôs how to reach me.‚Äù Without propagation enabled, even though resources are attached to the same Transit Gateway, they won‚Äôt be able to route traffic to each other because they don‚Äôt know the paths to reach one another.</p>

<h1 id="virtual-private-gateway">Virtual Private Gateway</h1>
<ul>
  <li>??</li>
</ul>

<h1 id="advanced-vpc-routing">Advanced VPC Routing</h1>

<ul>
  <li>Subnets are associated with 1 Route Table only
    <ul>
      <li>Either with Main RT or Custom RT</li>
    </ul>
  </li>
  <li>RT can associate with IGW/VGW</li>
  <li>RT controls how traffic is handled</li>
  <li>Static Routes -&gt; Manually</li>
  <li>Propagated route
    <ul>
      <li>Virtual Private Gateway attached</li>
      <li>If RT enabled and attached to VPG
        <ul>
          <li>Then RT will propagate route
Priorities:</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Lognest Prefix wins
    <ul>
      <li>e.g. /32 will take place over /16</li>
    </ul>
  </li>
  <li>Static Routes take priority over Propagated</li>
  <li>If All propagated, then priorities are:
    <ol>
      <li>DX</li>
      <li>VPN Static</li>
      <li>VPN BGP</li>
      <li>AS_PATH</li>
    </ol>
  </li>
  <li>To handle CIDE Overlap
    <ul>
      <li>Use RT per subnet to route to different VPC with same CIDR, under different Subnets</li>
      <li>OR use more specific, as RT takes Specific as priorities</li>
    </ul>
  </li>
  <li>INgress Routing (NEW)
    <ul>
      <li>Gateway Route Tables
  -&gt; Allow security inspection</li>
      <li>We use to be able to control what goes out, but doesn‚Äôt examine what goes in, hence this is introducd</li>
    </ul>
  </li>
</ul>

<h1 id="networking--hybrid">Networking &amp; Hybrid</h1>
<ul>
  <li>Basically Any Gateway should come with a RT</li>
  <li>RT can Associate or propagate
    <ul>
      <li>each attachment associate, but it can be configured to propagate</li>
    </ul>
  </li>
</ul>

<h2 id="accelerated-site-to-site-vpn">Accelerated Site to Site VPN</h2>
<ul>
  <li>Uses Same Global Network</li>
  <li>2 Resilient Public Space Endpoints</li>
  <li>2 IPSEC Tunnels</li>
  <li>Transit over the Public Internet</li>
  <li>Variable Performance/Latency/Consistency
    <ul>
      <li>Due to ‚Äúdifferent possible hops‚Äù</li>
    </ul>
  </li>
  <li>Alternative: Use Direct Connect Public VIF
    <ul>
      <li>Higher Cost</li>
    </ul>
  </li>
  <li>Ways to Connect to VPC
    <ol>
      <li>VGW to CGW (1:1 VPC) - Still over Public</li>
      <li>TGW to CGW (1:M VPC) - Still over Public</li>
      <li>Accelerated S2S VPN
        <ul>
          <li>Global AWS Network</li>
          <li>Minimal use of Public Network, and route to AWS Edge to entre AWS Network backbone</li>
          <li>Acceleration can ONLY be enabled by TGW VPN attachement.</li>
          <li>Not compatible with VPNs using VGW</li>
          <li>You need to also configure On-primses side to run BGP</li>
        </ul>
      </li>
    </ol>
  </li>
  <li>Explanation of Sequence:
    <ul>
      <li>On-Prem Router Configures BGP ASN: Your on-prem router sets up the BGP ASN and prepares to send/receive routing information.</li>
      <li>Advertise Internal Routes: The on-prem router advertises its internal subnets (e.g., 192.168.1.0/24) to AWS.</li>
      <li>AWS VPN Gateway Setup: The AWS VPN Gateway is configured, and VPN tunnels are established.</li>
      <li>BGP Peering: The on-prem router and AWS VPN Gateway establish a BGP peering session.</li>
      <li>Route Advertisement: AWS advertises the VPC subnets to the on-prem router.</li>
      <li>Route Learning: The on-prem router learns about the AWS subnets (VPC routes) via BGP.</li>
      <li>Traffic to AWS: Traffic from the on-prem network (destined for AWS) is routed based on BGP-learned routes.</li>
      <li>Forward Traffic via TGW: The Transit Gateway forwards the traffic to the correct AWS VPC.</li>
      <li>Return Traffic from AWS: Traffic from AWS (for example, from an EC2 instance) is routed back to the on-prem router via the established VPN.</li>
    </ul>
  </li>
</ul>

<h2 id="client-vpn">Client VPN</h2>
<ul>
  <li>Managed OpenVPN</li>
  <li>Connect to a Client VPN Endpoint</li>
  <li>One VPC</li>
  <li>1+ Networks (High availability)</li>
  <li>Billed based on network associations</li>
  <li>What is Client VPN for???</li>
  <li>Type:
    <ul>
      <li>Split Tunnel VPN
        <ul>
          <li>Connection to Internet is directly to Internet</li>
          <li>COnnection to AWS is connected through VPN ENI</li>
        </ul>
      </li>
      <li>Split tunnel IS NOT DEFAULT</li>
    </ul>
  </li>
  <li>Ability to integrate with identity based or certificate based Authentication</li>
  <li>Create Client VPN
    <ul>
      <li>Create ACM (Certificate)
        <ul>
          <li>What are the certificates use for?</li>
        </ul>
      </li>
      <li>I need to draw a sequence diagram
        <ul>
          <li>You then introduce a DNS Server IP to use</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="direct-connect">Direct Connect</h2>
<ul>
  <li>Physical Port Allocation at DX Location</li>
  <li>Port Hourly Cost &amp; Outbound Data transfer</li>
  <li>Provisioning Time
    <ul>
      <li>Physical Cables &amp; No Resilience (Weeks to month)</li>
      <li>Low and Consistent Latency with High Speed</li>
    </ul>
  </li>
  <li>DX Location
    <ul>
      <li>Not owned by AWS, usually a large regional data centre where AWS have space and equipment</li>
      <li>You setup a connection between:
        <ul>
          <li>AWS Direct Connect Cage (DX Port)</li>
          <li>Customer/Comms Partner Cage
            <ul>
              <li>Then your Comms/CustomerCage is connected to your on premises</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>VIFS:
    <ul>
      <li>Transit VIFs</li>
      <li>Public VIFs -&gt; Basically connect from your on premises to DXLocation to AWS Public</li>
      <li>Private VIFs -&gt; Basically connect to your own private</li>
    </ul>
  </li>
  <li>DX Physical COnnection Architecture
    <ul>
      <li>DX Connection = 1, 10, 100 Gbps speed
        <ul>
          <li>1 Gbps -&gt; 1000BASE-LX(1310nm)</li>
          <li>10 Gbps -&gt; 10GBASE-LX(1310nm)</li>
          <li>100 Gbps -&gt; 100GBASE-LR4</li>
        </ul>
      </li>
      <li>Requires Single Mode Fibre (NO Copper is allowed)</li>
      <li>Auto Negotiation Disabled
        <ul>
          <li>What does this mean?</li>
        </ul>
      </li>
      <li>Port Speed and full duplex manually set
        <ul>
          <li>What does this mean?</li>
        </ul>
      </li>
      <li>BGP / BGP MD5 AUthentication</li>
      <li>Optional MACsec and Bidirectional forwarding detection</li>
    </ul>
  </li>
  <li>MACSec
    <ul>
      <li>To address lack of build in encryption between ‚ÄúSwitch to Switch‚Äù</li>
      <li>Encryption of Frame (Layer 2) -&gt; IEEE 802.1AE-2018</li>
      <li>Hop by Hop -&gt; between switches/routers</li>
      <li>Confidentiality</li>
      <li>Data Integrity</li>
      <li>Data Origin Authority</li>
      <li>Replay Protection</li>
      <li>Does NOT reply End 2 End IPSEC over DX!!!</li>
      <li>Designed to allow for super high speed</li>
      <li>How it is done?
        <ul>
          <li>Secure Channel - Unidirectional (1 in 1 out)</li>
          <li>Secure Channel Identifier (SCI)</li>
          <li>Secure Associations - sessions on SC, generally 1 exists at a time (except when they are being replaced)</li>
          <li>Inserts a 16 bytes MACsec tag &amp; 16 bytes integrity Check Value (ICV)</li>
          <li>Key Agreement -&gt; Discovery, authentication, generation
            <ul>
              <li>CAK/CKN Pair with Connection</li>
            </ul>
          </li>
          <li>Cipher Suite</li>
        </ul>
      </li>
      <li>You can extended to you physical on premises, as long as you have Layer 2 Dedicated connection</li>
    </ul>
  </li>
</ul>

<p>DX Connection Process</p>
<ul>
  <li>LOA-CFA - Letter of AUthorzation customer facility Access
    <ul>
      <li>To Connect AWS Cage to your provider Cage</li>
      <li>AWS will allocate a port in AWS Cage and provide a form for you to complete</li>
      <li>Customer fill the form, then staff at Datacenter will perform the connection</li>
    </ul>
  </li>
</ul>

<p>DX Virtual Interfaces</p>
<ul>
  <li>BGP Session + VLAN
    <ul>
      <li>DX Connections are a layer 2 connection</li>
      <li>To connect Multiple types of layers 3 networks over the DX connection
  BGP exchanges routes/authenticates and VLAN isolates the network</li>
      <li>VLAN is used between DX Router and AWS Router
        <ul>
          <li>Each VLAN then maps to a VIF</li>
          <li>EACH VIF is then connected to your resouces</li>
        </ul>
      </li>
      <li>VLAN are BGP sessions, and authenticated via MD5</li>
    </ul>
  </li>
  <li>Concept of VIF</li>
  <li>Public / Private / Transit
    <ul>
      <li>Private VIFs
        <ul>
          <li>Acces 1 VPC resources using private IPs (can use TGW)</li>
          <li>Attach to VGWs - 1*VPC only</li>
          <li>in the same region as your DX Location</li>
          <li>1 Private VIF = 1 VGW = 1 VPC</li>
          <li>No Encryption on private VIFs</li>
          <li>Private VIFs are region specific, you can‚Äôt jump to another region</li>
        </ul>
      </li>
      <li>Public VIFs
        <ul>
          <li>Use to access Public Zone resources (e.g. SNS/SQS..etc)</li>
          <li>No direct acces to private VPC services</li>
          <li>Can access all public zone regions (across AWS GLobal network)</li>
          <li>AWS Advertise Public IP ranges to you</li>
          <li>You advertise any public IPs you won over BGP</li>
          <li>NOT Transitive, your prefixes dont leave AWS</li>
          <li>Direct Connect + VPN
            <ul>
              <li>VPN give Encrypted and Authenticated Tunnel</li>
              <li>Over DX (low latency and consistenty latency)</li>
              <li>Use Public VIF + VGW/TGW public endpoints</li>
              <li>VPN is Transit Agnostic and E2E encryption</li>
              <li>VPN as backup, direct connect as primary</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Direct Connect Gateway
    <ul>
      <li>DX is regional</li>
      <li>1+ DX Locations</li>
      <li>Public VIF can access all regions
        <ul>
          <li>since IPs for Public Service VIFs are more specific, hence it take priority</li>
        </ul>
      </li>
      <li>Private only Private IPs</li>
    </ul>
  </li>
</ul>

<p>Here‚Äôs the updated <strong>decision table</strong> with the distinction about <strong>one-way vs. bidirectional traffic</strong> and <strong>cross-premises flow</strong>:</p>

<hr />

<h3 id="-direct-connect-gateway-dxgw-vs-virtual-private-gateway-vgw-vs-transit-gateway-tgw--decision-table">‚úÖ <strong>Direct Connect Gateway (DXGW) vs. Virtual Private Gateway (VGW) vs. Transit Gateway (TGW) ‚Äì Decision Table</strong></h3>

<table>
  <thead>
    <tr>
      <th><strong>Use Case / Scenario</strong></th>
      <th><strong>Recommended Option</strong></th>
      <th><strong>Why?</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>‚úÖ <strong>Single VPC</strong> (in <strong>one region</strong>), connecting to <strong>on-prem</strong> via Direct Connect</td>
      <td><strong>VGW</strong></td>
      <td>Simple, low-overhead solution for <strong>one-way traffic</strong> between <strong>on-premises</strong> and <strong>single VPC</strong>.</td>
    </tr>
    <tr>
      <td>üåç <strong>Multiple VPCs in multiple regions</strong>, needing Direct Connect</td>
      <td><strong>DX Gateway</strong></td>
      <td>Supports <strong>one-way</strong> Direct Connect to multiple VPCs across regions, <strong>no cross-premises flow</strong>.</td>
    </tr>
    <tr>
      <td>üîÅ <strong>Multiple VPCs in the same region</strong>, shared Direct Connect link</td>
      <td><strong>Transit Gateway + DX Gateway</strong></td>
      <td><strong>TGW</strong> centralizes routing; <strong>DXGW</strong> connects on-prem, <strong>supports one-way</strong> traffic to/from VPCs.</td>
    </tr>
    <tr>
      <td>üè¢ <strong>Multiple AWS accounts</strong> (multi-account setup)</td>
      <td><strong>Transit Gateway + DX Gateway</strong></td>
      <td>Centralizes traffic routing and supports <strong>cross-account</strong>, <strong>cross-VPC</strong>, and <strong>cross-premises</strong> communication.</td>
    </tr>
    <tr>
      <td>üåê <strong>Global network</strong>, needing cross-premises and cross-region flow</td>
      <td><strong>Transit Gateway</strong></td>
      <td><strong>TGW</strong> supports <strong>cross-premises</strong> (on-prem to on-prem) and <strong>cross-VPC</strong> traffic <strong>bidirectionally</strong>.</td>
    </tr>
    <tr>
      <td>‚ö° <strong>High-performance routing</strong> between many VPCs, complex traffic management</td>
      <td><strong>Transit Gateway</strong></td>
      <td>Scalable and efficient routing hub for <strong>East-West</strong> VPC traffic and <strong>cross-premises</strong> traffic.</td>
    </tr>
    <tr>
      <td>üß™ <strong>Small-scale, legacy setup</strong>, no need to scale</td>
      <td><strong>VGW</strong></td>
      <td>Simple, <strong>one-way</strong> traffic routing from on-prem to a single VPC.</td>
    </tr>
    <tr>
      <td>üîê <strong>Fine-grained VPC-to-VPC traffic control</strong> (segmentation)</td>
      <td><strong>Transit Gateway</strong></td>
      <td><strong>TGW</strong> supports advanced route control, including segmentation via <strong>route domains</strong>.</td>
    </tr>
    <tr>
      <td>‚öôÔ∏è <strong>Hybrid setup</strong> with Direct Connect + VPN failover</td>
      <td><strong>VGW (simple)</strong> or <strong>TGW (complex)</strong></td>
      <td><strong>VGW</strong> for simpler hybrid, <strong>TGW</strong> for more complex hybrid with <strong>cross-premises</strong> routing.</td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="key-differences-at-a-glance"><strong>Key Differences at a Glance</strong>:</h3>

<table>
  <thead>
    <tr>
      <th><strong>Feature</strong></th>
      <th><strong>VGW</strong></th>
      <th><strong>DX Gateway</strong></th>
      <th><strong>Transit Gateway</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Traffic Flow</strong></td>
      <td><strong>One-way</strong> (On-prem to VPC)</td>
      <td><strong>One-way</strong> (On-prem to VPC)</td>
      <td><strong>Bidirectional</strong> (On-prem to VPC, VPC to VPC, On-prem to On-prem)</td>
    </tr>
    <tr>
      <td><strong>Cross-Premises Routing</strong></td>
      <td><strong>No</strong></td>
      <td><strong>No</strong></td>
      <td><strong>Yes</strong></td>
    </tr>
    <tr>
      <td><strong>Cross-VPC Routing (Same Region)</strong></td>
      <td><strong>No</strong></td>
      <td><strong>No</strong></td>
      <td><strong>Yes</strong></td>
    </tr>
    <tr>
      <td><strong>Multi-Region Support</strong></td>
      <td><strong>No</strong></td>
      <td><strong>Yes</strong></td>
      <td><strong>Yes</strong></td>
    </tr>
    <tr>
      <td><strong>VPC-to-VPC (Inter-region)</strong></td>
      <td><strong>No</strong></td>
      <td><strong>No</strong></td>
      <td><strong>Yes</strong></td>
    </tr>
    <tr>
      <td><strong>VPC-to-VPC (Same Region)</strong></td>
      <td><strong>No</strong></td>
      <td><strong>Yes</strong></td>
      <td><strong>Yes</strong></td>
    </tr>
    <tr>
      <td><strong>Multiple Account Support</strong></td>
      <td><strong>No</strong></td>
      <td><strong>No</strong></td>
      <td><strong>Yes</strong></td>
    </tr>
    <tr>
      <td><strong>Scalability</strong></td>
      <td><strong>Limited</strong></td>
      <td><strong>Limited (but better for multiple VPCs)</strong></td>
      <td><strong>High</strong></td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="summary"><strong>Summary</strong>:</h3>

<ul>
  <li><strong>VGW</strong>: Best for <strong>simple, single VPC</strong> or <strong>one-way traffic</strong> from on-prem to a VPC (no cross-VPC or cross-premises).</li>
  <li><strong>DX Gateway</strong>: Ideal for <strong>single-way</strong> Direct Connect to <strong>multiple VPCs</strong> (but no cross-premises or cross-VPC).</li>
  <li><strong>Transit Gateway</strong>: <strong>Bidirectional</strong> traffic routing for <strong>multi-region VPCs</strong>, <strong>cross-premises</strong>, <strong>cross-account</strong>, and complex traffic management.</li>
</ul>

<hr />

<p>Does this table clarify everything, especially around <strong>cross-premises</strong> and <strong>VPC-to-VPC</strong> traffic? Feel free to ask if you need further examples!</p>

<table>
  <thead>
    <tr>
      <th><strong>Record Type</strong></th>
      <th><strong>Purpose</strong></th>
      <th><strong>Example</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>NS</strong></td>
      <td>Points to authoritative name servers for a domain or subdomain.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com. IN NS ns1.dnsprovider.com.</code></td>
    </tr>
    <tr>
      <td><strong>A</strong></td>
      <td>Maps a domain to an IPv4 address.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com. IN A 192.0.2.1</code></td>
    </tr>
    <tr>
      <td><strong>AAAA</strong></td>
      <td>Maps a domain to an IPv6 address.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com. IN AAAA 2001:0db8::8a2e:0370:7334</code></td>
    </tr>
    <tr>
      <td><strong>CNAME</strong></td>
      <td>Alias for one domain, points to another domain (not an IP address).</td>
      <td><code class="language-plaintext highlighter-rouge">www.example.com. IN CNAME example.globalcdn.com.</code></td>
    </tr>
    <tr>
      <td><strong>MX</strong></td>
      <td>Directs email to mail servers for the domain.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com. IN MX 10 mail1.google.com.</code></td>
    </tr>
    <tr>
      <td><strong>TXT</strong></td>
      <td>Adds text information to the domain (e.g., ownership verification, SPF).</td>
      <td><code class="language-plaintext highlighter-rouge">example.com. IN TXT "google-site-verification=abcdefg12345"</code></td>
    </tr>
    <tr>
      <td><strong>Alias</strong></td>
      <td>Points to AWS resources (ELB, CloudFront, S3, etc.), replaces CNAME.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com. IN A Alias cloudfront-distribution-id.cloudfront.net.</code></td>
    </tr>
    <tr>
      <td><strong>SRV</strong></td>
      <td>Specifies a service (like a VoIP server, or other protocols).</td>
      <td><code class="language-plaintext highlighter-rouge">_sip._tcp.example.com. IN SRV 10 60 5060 sipserver.example.com.</code></td>
    </tr>
    <tr>
      <td><strong>PTR</strong></td>
      <td>Maps an IP address to a domain name (reverse DNS lookup).</td>
      <td><code class="language-plaintext highlighter-rouge">1.2.0.192.in-addr.arpa. IN PTR example.com.</code></td>
    </tr>
    <tr>
      <td><strong>SOA</strong></td>
      <td>Provides authoritative information about a domain, including the primary name server and email.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com. IN SOA ns1.dnsprovider.com. hostmaster.example.com. 2020101001 3600 1800 1209600 86400</code></td>
    </tr>
    <tr>
      <td><strong>CAA</strong></td>
      <td>Specifies which certificate authorities (CAs) are allowed to issue SSL certificates for the domain.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com. IN CAA 0 issue "letsencrypt.org"</code></td>
    </tr>
  </tbody>
</table>

<p>A naked domain is just the root domain with no subdomain (e.g., example.com), and it‚Äôs often treated specially in DNS setups due to limitations with CNAME records at the root level. Instead, services like Alias records (for AWS) or URL forwarding are used to handle these cases.
CNAME only allows www.catagram.io to catagram.io
But you can‚Äôt do catagram.io to <XXXXXX></XXXXXX></p>

<p>BUT ELBs or other are usually given WITHOUT the naked/apex domain</p>

<p>For Naked domain used Alias for AWS resources
    - for the type, you use the different type based on what you have. e.g. if ELB gives IP, then you use alias -&gt; A record
For non naked domain use CNAME</p>

<p>To summarize, here‚Äôs the flow:</p>

<ol>
  <li>You create a Hosted Zone in Route 53 for your domain (example.com).</li>
  <li>Route 53 assigns 4 authoritative name servers (NS records) for this domain.</li>
  <li>You add DNS records (like A, CNAME, MX, TXT, etc.) inside the hosted zone.</li>
  <li>When someone queries for example.com, the DNS resolver checks the NS records (your 4 authoritative name servers).</li>
  <li>The authoritative name servers provide the appropriate DNS records in response to the query (e.g., an A record with an IP address, MX record for email routing, etc.).</li>
</ol>

<p>! NEED TO ADD A SEQUENCE DIAGRAM ABOUT HOW TLD RESOLVES</p>

<p>Absolutely! Here‚Äôs a <strong>summary table</strong> of the different <strong>routing types</strong> in <strong>Route 53</strong>. This will help you understand how each routing policy works and when to use them.</p>

<h3 id="route-53-routing-policies-summary"><strong>Route 53 Routing Policies Summary</strong>:</h3>

<table>
  <thead>
    <tr>
      <th><strong>Routing Policy</strong></th>
      <th><strong>Description</strong></th>
      <th><strong>Use Case</strong></th>
      <th><strong>Technical Details</strong></th>
      <th><strong>Example</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Simple Routing</strong></td>
      <td>Default routing, single record response.</td>
      <td>For single resources (e.g., a single EC2, ELB).</td>
      <td>One <strong>A</strong> or <strong>CNAME</strong> record. No load balancing.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com</code> ‚Üí <code class="language-plaintext highlighter-rouge">A 192.0.2.1</code></td>
    </tr>
    <tr>
      <td><strong>Weighted Routing</strong></td>
      <td>Routes traffic based on weight percentages.</td>
      <td>For load balancing across multiple resources.</td>
      <td>Multiple <strong>A</strong>, <strong>CNAME</strong> records with <strong>weights</strong>. Route traffic based on percentage.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com</code> ‚Üí <code class="language-plaintext highlighter-rouge">A 192.0.2.1 weight=80</code>, <code class="language-plaintext highlighter-rouge">A 192.0.2.2 weight=20</code></td>
    </tr>
    <tr>
      <td><strong>Latency Routing</strong></td>
      <td>Routes traffic to the resource with the lowest latency, based on user location.</td>
      <td>For low-latency access across regions.</td>
      <td>Multiple records in AWS regions. Route 53 picks the region with the lowest latency for the user.</td>
      <td>U.S. users ‚Üí <code class="language-plaintext highlighter-rouge">us.example.com</code>, Europe users ‚Üí <code class="language-plaintext highlighter-rouge">eu.example.com</code> (based on latency).</td>
    </tr>
    <tr>
      <td><strong>Failover Routing</strong></td>
      <td>Routes to primary resource, failover to secondary if primary fails.</td>
      <td>High availability setups.</td>
      <td><strong>A</strong> or <strong>CNAME</strong> with health checks. Fallback to secondary if primary is unhealthy.</td>
      <td>Primary <code class="language-plaintext highlighter-rouge">example.com</code> ‚Üí <code class="language-plaintext highlighter-rouge">A 192.0.2.1</code>, failover to <code class="language-plaintext highlighter-rouge">backup.example.com</code> ‚Üí <code class="language-plaintext highlighter-rouge">A 192.0.2.2</code>.</td>
    </tr>
    <tr>
      <td><strong>Geolocation Routing</strong></td>
      <td>Routes based on the user‚Äôs geographic location (country/region).</td>
      <td>Region-specific content delivery.</td>
      <td><strong>A</strong>, <strong>CNAME</strong> records tagged with countries or regions.</td>
      <td>U.S. users ‚Üí <code class="language-plaintext highlighter-rouge">A 192.0.2.1</code>, UK users ‚Üí <code class="language-plaintext highlighter-rouge">A 192.0.2.2</code>, default ‚Üí <code class="language-plaintext highlighter-rouge">A 192.0.2.3</code>.</td>
    </tr>
    <tr>
      <td><strong>Geoproximity Routing</strong></td>
      <td>Routes based on user location and resource proximity, including <strong>bias</strong> for weighted routing.</td>
      <td>For region-based load balancing with proximity bias.</td>
      <td>Records tagged with AWS region. <strong>Proximity bias</strong> adjusts distance by lat/long and resource weights.</td>
      <td>New York users ‚Üí <code class="language-plaintext highlighter-rouge">A 192.0.2.1</code> (New Jersey server), LA users ‚Üí <code class="language-plaintext highlighter-rouge">A 192.0.2.2</code> (California server).</td>
    </tr>
    <tr>
      <td><strong>Multi-Value Answer Routing</strong></td>
      <td>Returns multiple IPs for load balancing and fault tolerance.</td>
      <td>Load balancing across multiple servers, fault tolerance.</td>
      <td>Multiple <strong>A</strong> or <strong>AAAA</strong> records. Health checks ensure only healthy IPs are returned.</td>
      <td><code class="language-plaintext highlighter-rouge">example.com</code> ‚Üí multiple <code class="language-plaintext highlighter-rouge">A</code> records: <code class="language-plaintext highlighter-rouge">A 192.0.2.1</code>, <code class="language-plaintext highlighter-rouge">A 192.0.2.2</code>, <code class="language-plaintext highlighter-rouge">A 192.0.2.3</code></td>
    </tr>
    <tr>
      <td><strong>IP-based Routing (Coming Soon)</strong></td>
      <td>Routes traffic based on the client‚Äôs IP address.</td>
      <td>Advanced routing for client-specific behavior.</td>
      <td>Routes based on <strong>IP blocks</strong> to specific resources. More granular than country-based routing.</td>
      <td>Route traffic from a specific IP block to a set of internal resources.</td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="quick-overview-of-each-routing-policy"><strong>Quick Overview of Each Routing Policy</strong>:</h3>

<ol>
  <li>
    <p><strong>Simple Routing</strong>:</p>

    <ul>
      <li><strong>Use when</strong>: You have a single resource that handles all the traffic.</li>
      <li><strong>Example</strong>: A single EC2 instance or ELB as the destination for all traffic to your domain.</li>
    </ul>
  </li>
  <li>
    <p><strong>Weighted Routing</strong>:</p>

    <ul>
      <li><strong>Use when</strong>: You want to distribute traffic across multiple resources based on weights (percentages).</li>
      <li><strong>Example</strong>: Testing new versions of a site by sending 20% of traffic to a new EC2 instance and 80% to the current one.</li>
    </ul>
  </li>
  <li>
    <p><strong>Latency Routing</strong>:</p>

    <ul>
      <li><strong>Use when</strong>: You have users in different regions and want to minimize latency by routing them to the closest region.</li>
      <li><strong>Example</strong>: Users in the U.S. should go to a U.S. server, and users in Europe to a European server.</li>
    </ul>
  </li>
  <li>
    <p><strong>Failover Routing</strong>:</p>

    <ul>
      <li><strong>Use when</strong>: You want to ensure high availability by routing traffic to a backup resource in case the primary resource fails.</li>
      <li><strong>Example</strong>: Main site is hosted on <code class="language-plaintext highlighter-rouge">example.com</code>; backup site is <code class="language-plaintext highlighter-rouge">backup.example.com</code>, and Route 53 will route traffic to <code class="language-plaintext highlighter-rouge">backup.example.com</code> if <code class="language-plaintext highlighter-rouge">example.com</code> is down.</li>
    </ul>
  </li>
  <li>
    <p><strong>Geolocation Routing</strong>:</p>

    <ul>
      <li><strong>Use when</strong>: You want to serve different content based on the user‚Äôs geographic location.</li>
      <li><strong>Example</strong>: Serve content in English to U.S. visitors and in French to visitors from France.</li>
    </ul>
  </li>
  <li>
    <p><strong>Geoproximity Routing</strong>:</p>

    <ul>
      <li><strong>Use when</strong>: You want to route traffic based on both the geographic location of your resources and the proximity to the client.</li>
      <li><strong>Example</strong>: Route traffic based on where your servers are physically located, but also adjust by proximity to the end user.</li>
    </ul>
  </li>
  <li>
    <p><strong>Multi-Value Answer Routing</strong>:</p>

    <ul>
      <li><strong>Use when</strong>: You want Route 53 to return multiple values (IPs) for a domain name.</li>
      <li><strong>Example</strong>: Load balancing between multiple EC2 instances or IPs.</li>
    </ul>
  </li>
  <li>
    <p><strong>IP-based Routing</strong> (Future feature):</p>

    <ul>
      <li><strong>Use when</strong>: You need to route traffic based on the client‚Äôs IP address.</li>
      <li><strong>Example</strong>: Routing traffic from certain IP blocks to specific servers, maybe for certain regions or clients with specific access rights.</li>
    </ul>
  </li>
</ol>

<hr />

<h3 id="key-differences"><strong>Key Differences</strong>:</h3>

<ul>
  <li><strong>Weighted</strong> and <strong>Multi-Value Answer</strong> routing allow multiple records to be returned, with <strong>Weighted</strong> giving you more control over how much traffic goes to each resource.</li>
  <li><strong>Latency</strong> and <strong>Geolocation</strong> routing focus on optimizing traffic based on the user‚Äôs location, while <strong>Geoproximity</strong> takes both the user and resource locations into account.</li>
  <li><strong>Failover</strong> routing is all about availability ‚Äî it ensures that if one resource goes down, traffic will automatically be redirected to a backup.</li>
</ul>

<hr />

<p>This table should give you a good overview of the different <strong>Route 53 routing policies</strong> and their use cases. Let me know if you need any further clarification!</p>

<p>sadservers¬†¬ª¬ª use for practices</p>

<h3 id="dnssec-summary"><strong>DNSSEC Summary:</strong></h3>

<p><strong>DNSSEC</strong> (Domain Name System Security Extensions) is a set of protocols used to <strong>secure DNS</strong> by ensuring the <strong>authenticity</strong> and <strong>integrity</strong> of DNS responses. It prevents attacks like <strong>DNS spoofing</strong>, <strong>cache poisoning</strong>, and <strong>man-in-the-middle</strong> (MITM) attacks.</p>

<h4 id="key-features">Key Features:</h4>

<ul>
  <li><strong>Authentication</strong>: DNSSEC ensures that DNS data hasn‚Äôt been tampered with by <strong>digitally signing</strong> records using cryptographic keys.</li>
  <li><strong>Integrity</strong>: It guarantees that the DNS data returned from authoritative servers is <strong>genuine</strong> and hasn‚Äôt been modified during transit.</li>
  <li><strong>No Encryption</strong>: Unlike HTTPS, DNSSEC does not encrypt DNS queries or responses; it only ensures they haven‚Äôt been altered.</li>
</ul>

<h4 id="core-components">Core Components:</h4>

<ol>
  <li><strong>Private and Public Keys</strong>: Each DNS zone has a <strong>public-private key pair</strong>. The private key is used to sign DNS records, while the public key is used by DNS resolvers to verify the authenticity of the response.</li>
  <li>
    <p><strong>DNSSEC Records</strong>:</p>

    <ul>
      <li><strong>DNSKEY</strong>: Contains the public key.</li>
      <li><strong>RRSIG</strong>: Contains the digital signature of DNS records.</li>
      <li><strong>DS</strong>: Delegation Signer record in the parent zone for linking DNSSEC chains.</li>
    </ul>
  </li>
  <li><strong>Chain of Trust</strong>: DNSSEC works by creating a <strong>chain of trust</strong> starting from the root DNS zone (signed with DNSSEC) to each domain.</li>
</ol>

<h4 id="how-it-works">How It Works:</h4>

<ol>
  <li><strong>Signing DNS Records</strong>: The DNS authoritative server signs the DNS records (A, MX, etc.) with its private key.</li>
  <li><strong>Verification</strong>: When a client queries a DNS resolver, the resolver checks the signature using the public key of the domain.</li>
  <li><strong>Validation</strong>: If the signature is valid, the DNS response is considered authentic. If the signature doesn‚Äôt match, the response is rejected.</li>
</ol>

<hr />
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@startuml
actor User
participant "DNS Resolver" as Resolver
participant "Root DNS Server" as Root
participant "TLD DNS Server" as TLD
participant "Parent DNS Server (TLD)" as Parent
participant "Authoritative DNS Server" as Authoritative

' Normal DNS Resolution (without DNSSEC)
== Normal DNS Resolution ==
User -&gt; Resolver : Query for "example.com"

note right of Resolver : Step 1: Query sent for domain resolution.

Resolver -&gt; Root : Request for "example.com" root zone

note right of Root : Step 2: Resolver queries the root DNS server to get the TLD server for `.com`.

Root -&gt; Resolver : Return `.com` TLD server address

note right of Resolver : Step 3: Resolver receives the `.com` TLD server address.

Resolver -&gt; TLD : Request for `example.com` domain server

note right of TLD : Step 4: Resolver queries the `.com` TLD server for the authoritative server of `example.com`.

TLD -&gt; Resolver : Return `example.com` authoritative DNS server address

note right of Resolver : Step 5: Resolver receives the address of the authoritative DNS server for `example.com`.

Resolver -&gt; Authoritative : Request for DNS records (A, MX) of `example.com`

note right of Authoritative : Step 6: Resolver queries the authoritative DNS server for DNS records like A (IP address) or MX (mail server).

Authoritative -&gt; Resolver : Return DNS records (A, MX)

note right of Resolver : Step 7: Resolver returns DNS records (e.g., IP addresses) to the User.

Resolver -&gt; User : Return DNS records (IP address for `example.com`)

note right of User : Step 8: User receives the IP address and can connect to the website.


' DNSSEC Enabled Resolution
== DNSSEC Resolution ==
User -&gt; Resolver : Query for "example.com"

note right of Resolver : Step 1: Query sent for domain resolution.

Resolver -&gt; Parent : Request DNSKEY for "example.com"

note right of Parent : Step 2: Resolver asks parent zone (e.g., `.com` TLD server) for the public key.

Parent -&gt; Parent : Look up DS Record for "example.com"
Parent -&gt; Resolver : Return DS Record for "example.com" (Delegation Signer)

note right of Resolver : Step 3: Parent zone returns DS record, forming a chain of trust.

Resolver -&gt; Authoritative : Request DNS records (A, MX) for "example.com"

note right of Authoritative : Step 4: Authoritative DNS Server looks up DNS records and signs them with private key.

Authoritative -&gt; Authoritative : Sign DNS records with private key and attach RRSIG (digital signature)

Resolver -&gt; Resolver : Validate DNS records using public key from Parent (via DS record) and RRSIG

note right of Resolver : Step 5: Resolver verifies DNS records using public key and checks RRSIG for authenticity.

Resolver -&gt; User : Return DNS records if valid

note right of User : Step 6: DNS records returned if the signature is valid.

@enduml


</code></pre></div></div>
<hr />

<h3 id="explanation-of-the-diagram"><strong>Explanation of the Diagram</strong>:</h3>

<ol>
  <li><strong>User Queries DNS Resolver</strong>: The <strong>User</strong> requests the domain <code class="language-plaintext highlighter-rouge">example.com</code> to resolve to an IP address.</li>
  <li><strong>Resolver Queries Root DNS Server</strong>: The <strong>DNS Resolver</strong> sends a query to the <strong>Root DNS Server</strong> to identify the <strong>TLD DNS Server</strong> for <code class="language-plaintext highlighter-rouge">.com</code>.</li>
  <li><strong>Root Server Returns TLD Server Address</strong>: The <strong>Root DNS Server</strong> responds with the address of the <strong>.com</strong> TLD DNS server.</li>
  <li><strong>Resolver Queries TLD DNS Server</strong>: The <strong>DNS Resolver</strong> sends a query to the <strong>.com TLD DNS Server</strong> to get the address of the <strong>Authoritative DNS Server</strong> for <code class="language-plaintext highlighter-rouge">example.com</code>.</li>
  <li><strong>TLD Server Returns Authoritative DNS Server Address</strong>: The <strong>TLD DNS Server</strong> responds with the address of the <strong>Authoritative DNS Server</strong> for <code class="language-plaintext highlighter-rouge">example.com</code>.</li>
  <li><strong>Resolver Queries Authoritative DNS Server</strong>: The <strong>DNS Resolver</strong> sends a query to the <strong>Authoritative DNS Server</strong> for DNS records (such as <code class="language-plaintext highlighter-rouge">A</code> or <code class="language-plaintext highlighter-rouge">MX</code> records) for <code class="language-plaintext highlighter-rouge">example.com</code>.</li>
  <li><strong>Authoritative DNS Server Responds with DNS Records</strong>: The <strong>Authoritative DNS Server</strong> responds with the <strong>DNS records</strong> (e.g., IP address) for <code class="language-plaintext highlighter-rouge">example.com</code>.</li>
  <li><strong>Resolver Returns DNS Records to User</strong>: The <strong>DNS Resolver</strong> returns the DNS records (e.g., IP address) to the <strong>User</strong>, which can now connect to the website.</li>
</ol>

<hr />

<h3 id="where-tampering-can-occur-without-dnssec"><strong>Where Tampering Can Occur Without DNSSEC</strong>:</h3>

<p>In this normal DNS resolution process, without DNSSEC, the DNS records can be <strong>tampered with</strong> at several points in the process. Below are the most vulnerable points:</p>

<ol>
  <li>
    <p><strong>DNS Cache Poisoning at Resolver</strong>:</p>

    <ul>
      <li><strong>Where</strong>: Between the <strong>User</strong> and the <strong>DNS Resolver</strong>, or the <strong>Resolver</strong> and the <strong>Root/TLD/Authoritative Servers</strong>.</li>
      <li><strong>How</strong>: An attacker could <strong>inject malicious DNS records</strong> into the DNS resolver‚Äôs cache, causing the resolver to return <strong>incorrect DNS records</strong> (like a fake IP address) when users try to visit a domain.</li>
      <li><strong>Impact</strong>: This can lead to <strong>phishing attacks</strong> or sending users to a <strong>malicious website</strong> instead of the legitimate one.</li>
    </ul>
  </li>
  <li>
    <p><strong>Man-in-the-Middle (MITM) Attacks</strong>:</p>

    <ul>
      <li><strong>Where</strong>: Between the <strong>Resolver</strong> and any of the DNS servers (Root, TLD, Authoritative).</li>
      <li><strong>How</strong>: An attacker can intercept and modify DNS responses, changing the IP addresses associated with a domain. The attacker can redirect users to malicious sites or intercept sensitive information.</li>
      <li><strong>Impact</strong>: <strong>Man-in-the-middle</strong> attacks can allow attackers to <strong>steal data</strong> or manipulate the destination of web traffic, such as redirecting to a <strong>fake banking site</strong> for phishing.</li>
    </ul>
  </li>
  <li>
    <p><strong>DNS Spoofing</strong>:</p>

    <ul>
      <li><strong>Where</strong>: Between the <strong>DNS Resolver</strong> and the <strong>Authoritative DNS Server</strong>.</li>
      <li><strong>How</strong>: An attacker could <strong>forge DNS responses</strong> to trick the resolver into accepting them. This is possible because DNS queries are often not authenticated, and an attacker could <strong>send a fake response</strong> to the resolver before it receives the legitimate response.</li>
      <li><strong>Impact</strong>: The attacker can redirect the user to a fake website or malicious server.</li>
    </ul>
  </li>
  <li>
    <p><strong>Man-in-the-Middle Attacks at the Authoritative Server</strong>:</p>

    <ul>
      <li><strong>Where</strong>: Between the <strong>DNS Resolver</strong> and the <strong>Authoritative DNS Server</strong>.</li>
      <li><strong>How</strong>: An attacker could intercept DNS traffic between the resolver and authoritative server, altering the records being sent.</li>
      <li><strong>Impact</strong>: The attacker could <strong>modify the IP address</strong> associated with a domain, redirecting users to malicious sites or servers.</li>
    </ul>
  </li>
</ol>

<hr />

<h3 id="how-dnssec-mitigates-these-risks"><strong>How DNSSEC Mitigates These Risks</strong>:</h3>

<ol>
  <li>
    <p><strong>Prevents Cache Poisoning</strong>:</p>

    <ul>
      <li>DNSSEC <strong>signs</strong> DNS records, and the <strong>resolver</strong> validates these signatures using the <strong>public key</strong> from the parent zone. If the signature doesn‚Äôt match, the resolver rejects the response. This ensures that no forged or tampered DNS records are accepted.</li>
    </ul>
  </li>
  <li>
    <p><strong>Prevents MITM Attacks</strong>:</p>

    <ul>
      <li>DNSSEC ensures that the DNS response is <strong>authenticated</strong>, and only trusted, signed records are accepted. Even if an attacker intercepts the DNS traffic, they cannot change the data without invalidating the digital signature.</li>
    </ul>
  </li>
  <li>
    <p><strong>Prevents DNS Spoofing</strong>:</p>

    <ul>
      <li>With DNSSEC, DNS records are <strong>signed</strong> using a <strong>private key</strong>, and the <strong>resolver</strong> verifies the authenticity of the records using the <strong>public key</strong>. This makes it virtually impossible for an attacker to forge a valid DNS response.</li>
    </ul>
  </li>
  <li>
    <p><strong>Provides Chain of Trust</strong>:</p>

    <ul>
      <li>DNSSEC builds a <strong>chain of trust</strong> from the <strong>root zone</strong> to the <strong>authoritative server</strong>. The <strong>parent zone</strong> signs the <strong>child zone‚Äôs public key</strong>, ensuring the legitimacy of the DNS records at every level.</li>
    </ul>
  </li>
</ol>

<hr />

<h3 id="conclusion"><strong>Conclusion</strong>:</h3>

<p>Without DNSSEC, the DNS resolution process is vulnerable to various attacks, like <strong>DNS cache poisoning</strong>, <strong>MITM attacks</strong>, and <strong>DNS spoofing</strong>, where attackers can inject or alter DNS responses. <strong>DNSSEC</strong> addresses these risks by <strong>digitally signing</strong> DNS records and enabling <strong>authentication</strong> at each step of the resolution process. This ensures the integrity and authenticity of DNS responses and prevents malicious tampering.</p>

<p>Gateway endpoint for S3/DDB, done by adding a route</p>

<p>Interface Endpoints, you get a ‚Äúnew endpoint service name‚Äù
    - This is different to gateway endpoint.
    - e.g. vpce-123-xyz‚Ä¶‚Ä¶
        - Regional / Zonal DNS
    - No HA by default
        - TO be HA you need to add one per AZ
    - PrivateDNS overrides the default DNS
        - you basically create a PrivateDNS</p>

<p>VPC Endpoint policies</p>

    </article>
  </main>

  <footer class="site-footer">
    <span>¬© 2025 glucolte ‚Ä¢ </span>
    <a href="https://github.com/gLuColte/glucolte.github.io">source</a>
  </footer>

  <script>
    // Initialize highlight.js after the DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      hljs.highlightAll();
      
      // Add TOC functionality
      const toc = document.querySelector('#markdown-toc');
      if (toc) {
        // Create TOC container with header
        const tocContainer = document.createElement('div');
        tocContainer.className = 'toc-container';
        tocContainer.style.cssText = `
          background: #f8fafc;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 16px;
          margin: 20px 0;
          position: relative;
        `;
        
        // Add TOC header
        const tocHeader = document.createElement('h3');
        tocHeader.textContent = 'Table of Contents';
        tocHeader.style.cssText = `
          margin: 0 0 12px 0;
          font-size: 16px;
          font-weight: 600;
          color: #374151;
        `;
        
        // Add back to top button
        const backToTopBtn = document.createElement('button');
        backToTopBtn.textContent = '‚Üë Top';
        backToTopBtn.style.cssText = `
          position: absolute;
          top: 12px;
          right: 12px;
          background: #ffffff;
          border: 1px solid #d1d5db;
          border-radius: 6px;
          padding: 4px 8px;
          font-size: 12px;
          cursor: pointer;
          color: #6b7280;
          transition: all 0.2s ease;
        `;
        
        // Add hover effect for back to top button
        backToTopBtn.addEventListener('mouseenter', function() {
          this.style.background = '#f3f4f6';
          this.style.color = '#374151';
        });
        
        backToTopBtn.addEventListener('mouseleave', function() {
          this.style.background = '#ffffff';
          this.style.color = '#6b7280';
        });
        
        // Back to top functionality
        backToTopBtn.addEventListener('click', function() {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        // Style the TOC list
        toc.style.cssText = `
          margin: 0;
          padding: 0;
          font-size: 14px;
          line-height: 1.5;
        `;
        
        // Insert header and button into container
        tocContainer.appendChild(tocHeader);
        tocContainer.appendChild(backToTopBtn);
        tocContainer.appendChild(toc);
        
        // Replace the original TOC with the new container
        toc.parentNode.insertBefore(tocContainer, toc);
        tocContainer.appendChild(toc);
        
        // Add smooth scrolling to TOC links
        const tocLinks = toc.querySelectorAll('a');
        tocLinks.forEach(link => {
          link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetElement = document.getElementById(targetId);
            if (targetElement) {
              targetElement.scrollIntoView({ behavior: 'smooth' });
            }
          });
        });
      }
    });
  </script>
</body>
</html>
